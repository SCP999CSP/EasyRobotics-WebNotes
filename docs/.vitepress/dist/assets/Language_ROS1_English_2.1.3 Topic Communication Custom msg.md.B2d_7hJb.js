import{_ as a,c as e,o as i,af as n,aw as t}from"./chunks/framework.DSuiHQgX.js";const m=JSON.parse('{"title":"2.1.3 Topic Communication Custom msg","description":"","frontmatter":{},"headers":[],"relativePath":"Language/ROS1/English/2.1.3 Topic Communication Custom msg.md","filePath":"Language/ROS1/English/2.1.3 Topic Communication Custom msg.md"}'),l={name:"Language/ROS1/English/2.1.3 Topic Communication Custom msg.md"};function p(o,s,r,d,c,h){return i(),e("div",null,[...s[0]||(s[0]=[n(`<h1 id="_2-1-3-topic-communication-custom-msg" tabindex="-1">2.1.3 Topic Communication Custom msg <a class="header-anchor" href="#_2-1-3-topic-communication-custom-msg" aria-label="Permalink to “2.1.3 Topic Communication Custom msg”">​</a></h1><p>In the ROS communication protocol, the data carrier is a relatively important component. ROS encapsulates some native data types through std_msgs, such as: String, Int32, Int64, Char, Bool, Empty... However, these data types generally only contain one data field. The simplicity of the structure implies functional limitations. When transmitting some complex data, such as LiDAR information... std_msgs appear inadequate due to poor descriptiveness. In such scenarios, custom message types can be used.</p><p>msgs are simple text files, each line has a field type and field name. The available field types are:</p><ul><li>int8, int16, int32, int64 (or unsigned types: uint*)</li><li>float32, float64</li><li>string</li><li>time, duration</li><li>other msg files</li><li>variable-length array[] and fixed-length array[C]</li></ul><p>There is also a special type in ROS: <code>Header</code>. The header contains timestamp and coordinate frame information commonly used in ROS. You will often see the first line of a msg file has <code>Header</code>.</p><hr><p><strong>Requirement:</strong> Create a custom message that contains person information: name, height, age, etc.</p><p><strong>Process:</strong></p><ol><li>Create the msg file according to the fixed format</li><li>Edit the configuration files</li><li>Compile to generate intermediate files that can be called by Python or C++</li></ol><h4 id="_1-define-msg-file" tabindex="-1">1. Define msg file <a class="header-anchor" href="#_1-define-msg-file" aria-label="Permalink to “1. Define msg file”">​</a></h4><p>Create a new msg directory under the functional package, add the file Person.msg</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>string name</span></span>
<span class="line"><span>uint16 age</span></span>
<span class="line"><span>float64 height</span></span></code></pre></div><h4 id="_2-edit-configuration-files" tabindex="-1">2. Edit configuration files <a class="header-anchor" href="#_2-edit-configuration-files" aria-label="Permalink to “2. Edit configuration files”">​</a></h4><p>Add build dependencies and execution dependencies in <strong>package.xml</strong></p><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">build_depend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;message_generation&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">build_depend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">exec_depend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;message_runtime&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">exec_depend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  exce_depend 以前对应的是 run_depend 现在非法</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  --&gt;</span></span></code></pre></div><p>Edit msg-related configurations in <strong>CMakeLists.txt</strong></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>find_package(catkin REQUIRED COMPONENTS</span></span>
<span class="line"><span>  roscpp</span></span>
<span class="line"><span>  rospy</span></span>
<span class="line"><span>  std_msgs</span></span>
<span class="line"><span>  message_generation</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span># Need to include message_generation, must have std_msgs</span></span></code></pre></div><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>## Configure msg source files</span></span>
<span class="line"><span>add_message_files(</span></span>
<span class="line"><span>  FILES</span></span>
<span class="line"><span>  Person.msg</span></span>
<span class="line"><span>)</span></span></code></pre></div><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span># Depends on std_msgs when generating messages</span></span>
<span class="line"><span>generate_messages(</span></span>
<span class="line"><span>  DEPENDENCIES</span></span>
<span class="line"><span>  std_msgs</span></span>
<span class="line"><span>)</span></span></code></pre></div><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span># Execution dependencies</span></span>
<span class="line"><span>catkin_package(</span></span>
<span class="line"><span>#  INCLUDE_DIRS include</span></span>
<span class="line"><span>#  LIBRARIES demo02_talker_listener</span></span>
<span class="line"><span>  CATKIN_DEPENDS roscpp rospy std_msgs message_runtime</span></span>
<span class="line"><span>#  DEPENDS system_lib</span></span>
<span class="line"><span>)</span></span></code></pre></div><h4 id="_3-compile" tabindex="-1">3. Compile <a class="header-anchor" href="#_3-compile" aria-label="Permalink to “3. Compile”">​</a></h4><p><strong>View the compiled intermediate files:</strong></p><p>Intermediate files needed for Python calls (.../workspace/devel/lib/python3/dist-packages/package_name/msg)</p><p><img src="`+t+'" alt="img"></p><p>Subsequent calls to related msg will be made from these intermediate files.</p>',25)])])}const k=a(l,[["render",p]]);export{m as __pageData,k as default};
