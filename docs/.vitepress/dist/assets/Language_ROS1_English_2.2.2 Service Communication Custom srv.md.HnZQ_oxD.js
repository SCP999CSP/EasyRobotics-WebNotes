import{_ as e,c as i,o as a,af as n,az as t}from"./chunks/framework.DSuiHQgX.js";const k=JSON.parse('{"title":"2.2.2 Service Communication Custom srv","description":"","frontmatter":{},"headers":[],"relativePath":"Language/ROS1/English/2.2.2 Service Communication Custom srv.md","filePath":"Language/ROS1/English/2.2.2 Service Communication Custom srv.md"}'),l={name:"Language/ROS1/English/2.2.2 Service Communication Custom srv.md"};function p(r,s,o,c,d,h){return a(),i("div",null,[...s[0]||(s[0]=[n(`<h1 id="_2-2-2-service-communication-custom-srv" tabindex="-1">2.2.2 Service Communication Custom srv <a class="header-anchor" href="#_2-2-2-service-communication-custom-srv" aria-label="Permalink to “2.2.2 Service Communication Custom srv”">​</a></h1><p><strong>Requirement:</strong></p><blockquote><p>In service communication, the client submits two integers to the server, the server sums them and responds with the result to the client. Please create the data carrier for server and client communication.</p></blockquote><p><strong>Process:</strong></p><p>The available data types within an srv file are the same as those in a msg file, and the process for defining an srv is similar to the custom msg implementation process:</p><ol><li>Create the srv file according to the fixed format</li><li>Edit the configuration files</li><li>Compile to generate intermediate files</li></ol><h4 id="_1-define-srv-file" tabindex="-1">1. Define srv file <a class="header-anchor" href="#_1-define-srv-file" aria-label="Permalink to “1. Define srv file”">​</a></h4><p>In service communication, the data is divided into two parts: the request and the response. In the srv file, the request and response are separated by <code>---</code>. The specific implementation is as follows:</p><p>Create a new srv directory under the functional package, add an xxx.srv file with the content:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span># The two numbers sent by the client when making a request</span></span>
<span class="line"><span>int32 num1</span></span>
<span class="line"><span>int32 num2</span></span>
<span class="line"><span>---</span></span>
<span class="line"><span># The data sent by the server in response</span></span>
<span class="line"><span>int32 sum</span></span></code></pre></div><h4 id="_2-edit-configuration-files" tabindex="-1">2. Edit configuration files <a class="header-anchor" href="#_2-edit-configuration-files" aria-label="Permalink to “2. Edit configuration files”">​</a></h4><p>Add build dependencies and execution dependencies in <strong>package.xml</strong></p><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">build_depend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;message_generation&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">build_depend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">exec_depend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;message_runtime&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">exec_depend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  exce_depend was previously corresponding to run_depend, which is now invalid</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  --&gt;</span></span></code></pre></div><p>Edit srv-related configurations in <strong>CMakeLists.txt</strong></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>find_package(catkin REQUIRED COMPONENTS</span></span>
<span class="line"><span>  roscpp</span></span>
<span class="line"><span>  rospy</span></span>
<span class="line"><span>  std_msgs</span></span>
<span class="line"><span>  message_generation</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span># Need to include message_generation, must have std_msgs</span></span></code></pre></div><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>add_service_files(</span></span>
<span class="line"><span>  FILES</span></span>
<span class="line"><span>  AddInts.srv</span></span>
<span class="line"><span>)</span></span></code></pre></div><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>generate_messages(</span></span>
<span class="line"><span>  DEPENDENCIES</span></span>
<span class="line"><span>  std_msgs</span></span>
<span class="line"><span>)</span></span></code></pre></div><p>Note: The official ROS documentation does not configure <code>message_runtime</code> in <code>catkin_package</code>, but testing shows that configuring it also works.</p><h4 id="_3-compile" tabindex="-1">3. Compile <a class="header-anchor" href="#_3-compile" aria-label="Permalink to “3. Compile”">​</a></h4><p>View the compiled intermediate files:</p><p>Intermediate files needed for Python calls (.../workspace/devel/lib/python3/dist-packages/package_name/srv)</p><p><img src="`+t+'" alt="img"></p><p>Subsequent calls to related srv will be made from these intermediate files.</p>',23)])])}const m=e(l,[["render",p]]);export{k as __pageData,m as default};
